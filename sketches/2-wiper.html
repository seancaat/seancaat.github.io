<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<title>Wiper</title>
<meta name="Sean" content="">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../css/tachyons.css">
<script type="text/javascript" src="../js/two.min.js"></script>
<script type="text/javascript" src="../js/Tween.js"></script>
<script type="text/javascript" src="../js/RequestAnimationFrame.js"></script>  
<script src='https://cdn.rawgit.com/seancaat/randomized-form/master/jquery.min.js'></script>
  
<body>

  <section id="rl" class="w-100 vh-100">
    <p style="position: fixed; bottom:0%; width: 100%; font-weight: 300; text-align: center; ">click or tap</p>
  </section>
  
  <script>
      var colors = [
        'rgb(236,112,99)',
        'rgb(155,96,52)',
        'rgb(245,189,75)',
        'rgb(231,231,130)',
        'rgb(234,240,183)',
        'rgb(173,213,167)',
        'rgb(106,183,128)',
        'rgb(109,191,137)',
        'rgb(34,95,62)',
        'rgb(124,199,177)',
        'rgb(106,188,204)',
        'rgb(131,207,240)',
        'rgb(184,209,236)',
        'rgb(62,88,167)',
        'rgb(212,175,207)',
        'rgb(245,219,234)',
        'rgb(250,190,208)',
        'rgb(245,287,203)',
        'rgb(211,3,34)',
        'rgb(90,86,88)',
        'rgb(113,113,113)',
        'rgb(202,202,202)',
      ];
    
    var elem = document.getElementById('rl');
    var params = { width: window.innerWidth, height: window.innerHeight };
    var two = new Two(params).appendTo(elem);

    var mid = {x: two.width / 2, y: two.height / 2};
    var width = two.width;
    var height = two.height;
    
    var rect;
    
    $( "#rl" ).click(function() {
      draw_rect();
      animate_rect();
    });
    
    function draw_rect() {
      // maybe set up controls. click top middle means vert, click bottom middle means horiz. left means slant right, right means slant left?
      var r = Math.random();
    
      if (r <= 0.333) {
        rect = two.makeRectangle(mid.x, mid.y, 50, 3 * height);
        rect.noFill();
        rect.noStroke(); 
        two.update();
      } else if (r >= 0.333 && r <= 0.666) {
        rect = two.makeRectangle(mid.x, mid.y, 3 * height, 50);
        rect.noFill();
        rect.noStroke(); 
        two.update();
      } else {
        rect = two.makeRectangle(mid.x, mid.y, 3 * height, 50);
        rect.noFill();
        rect.noStroke(); 
        if (Math.random() >= 0.500) {
          rect.rotation = Math.PI / 4;  
        } else {
          rect.rotation = Math.PI * 3 / 4;
        }
        
      }
    }    
    function animate_rect() {
      var fill = colors[Math.floor(Math.random() * colors.length)];
      rect.fill = fill;
      var rect_tween = new TWEEN.Tween(rect);
      rect_tween.to({scale: 30,}, 450)
                .easing(TWEEN.Easing.Exponential.In)
                .start();
      
      // but then if you click before the animation is compelete, then the new background doesn't get set. is there something to take care of this? i.e. while animation is running, click does nothing?
      rect_tween.onComplete(function() {
        $( "#rl" ).css("background", fill);
        two.remove(rect);
        two.update();
      });
      
      animate();
  
      function animate() {
        requestAnimationFrame(animate);
        TWEEN.update();
        two.update();
      }
    }
      
  </script>
  
</body>
  
  